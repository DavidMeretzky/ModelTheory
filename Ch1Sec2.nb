(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     79523,       2379]
NotebookOptionsPosition[     74267,       2242]
NotebookOutlinePosition[     74623,       2258]
CellTagsIndexPosition[     74580,       2255]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 StyleBox["Construction of a Free Algebra\nChapter 1 Section 2\n",
  FontFamily->"Times New Roman",
  FontWeight->"Regular"],
 StyleBox["David Meretzky ", "Subchapter",
  FontFamily->"Times New Roman",
  FontSize->34,
  FontWeight->"Regular"]
}], "Chapter",
 CellChangeTimes->{{3.726750971131907*^9, 3.726750988634019*^9}, {
  3.7267510587845573`*^9, 3.7267510616562557`*^9}, {3.726751106050185*^9, 
  3.726751109495335*^9}},ExpressionUUID->"d86b0f59-3120-432d-9e0c-\
18d4d2cc1c63"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Combinatorica`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.726755451267157*^9, 
  3.7267554512963467`*^9}},ExpressionUUID->"703483ff-51dc-4866-9cd6-\
1c90737f2b23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "A", ",", "arity", ",", "a", ",", "b", ",", "e", ",", "j", ",", "k", ",", 
    "l", ",", "i", ",", "m", ",", "t", ",", "T", ",", "F", ",", "f"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQ/S7N/ofpkdeOgWxynGZA+rfeOl4Q3Re1HUwXKMcZ
gGiVVWvA9MEPkbYg+tnqJfYg+t15bTcQbfai1BNEb3OUCQbRGZ8fg+kjPJyJ
YHpiQxJY3cLKYhAt4/CwFESfnbiuDkQ/+t/WCqKPvTjYA6I37djYB6KZnPmm
geiiEBswLRLkvQzsvuvbV4Lo7PrVZ0C037S9F0C03O+mK2D3vusF0xZNGrdA
9IyOr2BaQqjzbyKQ3se5+D+Irjh5IyAJSF87ERACom+cNFJKBtLWfWZgWk4l
3CYdSJucawfTukslsruBtLh1dx6IniK0pQhEv2D9AaYZ7yln9AHphU3bM0E0
AJv9ubk=
  "],ExpressionUUID->"85b6d06e-4233-4f89-9cef-d35747bc0762"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Some", " ", "helper", " ", "functions"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7268493197578793`*^9, 
  3.726849326717477*^9}},ExpressionUUID->"e38b899b-2004-49af-97eb-\
513fcdaa44b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"partitions", "[", 
     RowBox[{"n_", ",", " ", "arity_"}], "]"}], ":=", " ", 
    RowBox[{"Return", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sp", " ", "=", " ", 
       RowBox[{"SetPartitions", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", " ", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "sp", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"sp", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "<", "arity"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sp", " ", "=", " ", 
             RowBox[{"Join", "[", 
              RowBox[{"sp", ",", 
               RowBox[{"Permutations", "[", 
                RowBox[{"PadLeft", "[", 
                 RowBox[{
                  RowBox[{"sp", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "arity"}], "]"}], 
                "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "sp", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"sp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "arity"}], " ", "||",
             " ", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"sp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "<", "arity"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sp", " ", "=", " ", 
             RowBox[{"Drop", "[", 
              RowBox[{"sp", ",", " ", 
               RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"i", " ", "=", " ", 
             RowBox[{"i", "-", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Union", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"Length", ",", "#"}], "]"}], "&"}], ",", "sp"}], "]"}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"genCartesianProduct", "[", "l_", "]"}], ":=", " ", 
    RowBox[{"Return", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nl", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"i", " ", "<=", " ", 
         RowBox[{
          RowBox[{"Length", "[", "l", "]"}], "-", "1"}]}], ",", 
        RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", " ", "\[Equal]", "1"}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Length", "[", "l", "]"}], ">", "1"}]}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nl", " ", "=", " ", 
             RowBox[{"CartesianProduct", "[", 
              RowBox[{
               RowBox[{"l", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"l", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", " ", "\[Equal]", "1"}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Length", "[", "l", "]"}], "==", "1"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<broke\>\"", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"nl", " ", "=", " ", "l"}], ";", "\[IndentingNewLine]", 
            "Break", ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", " ", ">", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nl", " ", "=", " ", 
             RowBox[{"CartesianProduct", "[", 
              RowBox[{"nl", ",", 
               RowBox[{"l", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{"Flatten", ",", "nl"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"depth_", ",", "type_"}], "]"}], ":=", " ", 
    RowBox[{"Return", "[", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"f", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"For", " ", "each", " ", "operatior"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", " ", "=", " ", "1"}], ",", 
        RowBox[{"j", " ", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"type", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], " ", ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"arity", " ", "=", " ", 
          RowBox[{
           RowBox[{"type", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "j"}], "]"}], "]"}], "/.", " ", "ar"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cp", " ", "=", " ", 
          RowBox[{"CartesianProduct", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"type", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "j"}], "]"}], "]"}], "}"}], "}"}], "}"}], 
            ",", 
            RowBox[{"partitions", "[", 
             RowBox[{
              RowBox[{"depth", "-", "1"}], ",", " ", "arity"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"f", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{"f", ",", "cp"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "f"}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rePartition", "[", "tuple_", "]"}], ":=", " ", 
   RowBox[{"Return", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"feed", " ", "=", " ", "tuple"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ari", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "/.", "ar"}], "&"}], ",", "feed"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"isNumeric", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"NumericQ", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "/.", "ar"}], "&"}], ",", "feed"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"p", " ", "=", 
        RowBox[{"Length", "[", "isNumeric", "]"}]}], ",", 
       RowBox[{"p", "\[GreaterEqual]", " ", "1"}], ",", 
       RowBox[{"--", "p"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"isNumeric", "[", 
           RowBox[{"[", "p", "]"}], "]"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rep", " ", "=", " ", 
            RowBox[{"Part", "[", 
             RowBox[{"feed", ",", 
              RowBox[{
               RowBox[{"(", "p", ")"}], ";;", 
               RowBox[{"(", 
                RowBox[{"p", "+", 
                 RowBox[{"ari", "[", 
                  RowBox[{"[", "p", "]"}], "]"}]}], ")"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"feed", "[", 
             RowBox[{"[", "p", "]"}], "]"}], " ", "=", " ", "rep"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"feed", "=", " ", 
            RowBox[{"Drop", "[", 
             RowBox[{"feed", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p", "+", "1"}], ",", 
                RowBox[{"p", "+", 
                 RowBox[{"ari", "[", 
                  RowBox[{"[", "p", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"feed", ",", "1"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.726837720149839*^9, 3.726837736494554*^9}, {
  3.726838019887052*^9, 3.72683812144059*^9}, {3.726838197147882*^9, 
  3.726838227308473*^9}, {3.726838288522708*^9, 3.726838356101448*^9}, {
  3.72683839712094*^9, 3.726838470655006*^9}, {3.726838649657133*^9, 
  3.726838652496647*^9}, {3.726838701177835*^9, 3.7268388720414057`*^9}, {
  3.726838909360118*^9, 3.726838967197968*^9}, {3.726839036642152*^9, 
  3.726839119825321*^9}, {3.72683918384973*^9, 3.726839284556162*^9}, {
  3.726849311046249*^9, 3.726849335104298*^9}, {3.72693080016455*^9, 
  3.72693080177322*^9}},ExpressionUUID->"df4ede1b-780f-4ded-95e2-\
f602cccfe8fb"],

Cell[CellGroupData[{

Cell[TextData[{
 "Create a type ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "a7e3f816-7fe2-460b-a6c6-f500cf099cb5"]
}], "Subsection",
 CellChangeTimes->{{3.726930829203012*^9, 3.72693083232969*^9}, {
  3.7269308697548523`*^9, 
  3.726930870581254*^9}},ExpressionUUID->"b142a881-cb18-4eff-9c8e-\
0b399f4fa3ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"T", " ", "=", " ", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t0", ",", "t1", ",", "t2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ar", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t0", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"t1", " ", "\[Rule]", " ", "1"}], ",", " ", 
         RowBox[{"t2", " ", "\[Rule]", " ", "2"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Let", " ", 
    SubscriptBox["T", "n"], " ", "denote", " ", "the", " ", "subset", " ", 
    "of", " ", "the", " ", "type", " ", "T", " ", "with", " ", "arity", " ", 
    RowBox[{"n", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["T", "n_"], ":=", " ", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "/.", "ar"}], ")"}], "\[Equal]", "n"}], "&"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.7269307934268723`*^9, 
  3.726930835362506*^9}},ExpressionUUID->"3c339186-162a-459c-bb2a-\
cbded43bf39a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"For", " ", "instance"}], ",", " ", 
   RowBox[{
    SubscriptBox["T", 
     RowBox[{"1", " "}]], "is", " ", "a", " ", "list", " ", "of", " ", "the", 
    " ", "arity", " ", "1", " ", "operations", " ", "of", " ", "the", " ", 
    "type", " ", "T"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.726750901349083*^9, 3.726750924588222*^9}, 
   3.7267510326653337`*^9, {3.7267513456523247`*^9, 
   3.726751348331943*^9}},ExpressionUUID->"905f07fb-6a73-4192-b0bf-\
8d7ef5181294"],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox["T", "0"]], "Input",
 CellChangeTimes->{{3.726750221392905*^9, 3.726750251080154*^9}, {
  3.726750335463566*^9, 3.726750338878972*^9}, {3.726750371650038*^9, 
  3.726750371729231*^9}, {3.726751349788889*^9, 3.726751349931939*^9}, {
  3.726751400795364*^9, 
  3.7267514036264753`*^9}},ExpressionUUID->"9b584e6e-7e03-4d18-81e7-\
1d76fb695859"],

Cell[BoxData[
 RowBox[{"{", "t0", "}"}]], "Output",
 CellChangeTimes->{{3.726750222538224*^9, 3.726750275143427*^9}, {
   3.726750335995904*^9, 3.7267503720758123`*^9}, 3.726750926348963*^9, {
   3.726751359476749*^9, 3.7267514040593767`*^9}, 3.72675657542006*^9, 
   3.726756743358921*^9, 3.726757220720792*^9, 3.726779892519765*^9, 
   3.72678000891145*^9, {3.726837170001089*^9, 3.726837180027375*^9}, 
   3.7268393580806437`*^9, 3.726839493011714*^9, 3.7268396829859457`*^9, 
   3.726839771721712*^9, 3.7268398147672787`*^9, {3.7268404602304773`*^9, 
   3.726840484773033*^9}, 3.726840747078537*^9, 3.726842121008546*^9, 
   3.7268423834475203`*^9, {3.726842798374384*^9, 3.726842802980041*^9}, 
   3.7268428512658033`*^9, 3.726842892591703*^9, 3.726849272780945*^9, 
   3.72692364413587*^9, {3.72692465213358*^9, 
   3.726924698392406*^9}},ExpressionUUID->"48a12df7-eff1-4d0e-91cd-\
d8259a9aba60"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"T", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.726839762488257*^9, 
  3.7268397659347363`*^9}},ExpressionUUID->"fc93898d-3d5a-4b99-aea2-\
89839972ce1c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"t0", ",", "t1", ",", "t2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.726757393400838*^9, 3.726779897357009*^9, 3.7267800159235287`*^9, {
   3.726837170183079*^9, 3.7268371904021807`*^9}, 3.7268394979411497`*^9, 
   3.726839693589569*^9, 3.726839766217033*^9, 3.726839820915976*^9, 
   3.7268404905864563`*^9, 3.726840751585207*^9, 3.726842121087899*^9, {
   3.726842798414727*^9, 3.72684280302013*^9}, 3.726842851287261*^9, 
   3.726842892612084*^9, 3.72684927390469*^9, 3.726923645516996*^9, {
   3.726924653628447*^9, 3.726924663344802*^9}, 
   3.726924701621538*^9},ExpressionUUID->"b642c82a-8328-43b4-9e09-\
7abc7e41562f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Create a Set ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "cbc7accd-c7a8-443f-8c36-f4de89d7c6b8"]
}], "Subsection",
 CellChangeTimes->{{3.726930829203012*^9, 
  3.726930865485601*^9}},ExpressionUUID->"9ff5fc5f-efd5-4c0f-872e-\
f3923a3d0501"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "We", " ", "will", " ", "use", " ", "the", " ", "set", " ", "of", " ", 
   "two", " ", "elements"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.726930386566099*^9, 
  3.726930397318845*^9}},ExpressionUUID->"56843c93-3015-44e3-b83d-\
25ea5fdc9b0e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"X", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"a", ",", "b"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.726849733746895*^9, 3.726849735546589*^9}, {
  3.726924731159622*^9, 
  3.7269247316784143`*^9}},ExpressionUUID->"4d6a05a5-4129-4925-b446-\
fddded318311"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ",", "b"}], "}"}]], "Output",
 CellChangeTimes->{3.72684973714406*^9, 3.726924731941421*^9, 
  3.726930255126297*^9, 3.726930403159006*^9, 
  3.726930850288355*^9},ExpressionUUID->"12a766bf-af2b-48b8-9f2d-\
a993c6a542c6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Create ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "0"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "eaceed09-36ca-493d-9669-d5a5b7adafff"]
}], "Subsection",
 CellChangeTimes->{{3.726930829203012*^9, 
  3.726930861769826*^9}},ExpressionUUID->"59a3d124-b685-4383-8353-\
ec35d547a2ec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["F", "0"], " ", "=", " ", 
  RowBox[{"Union", "[", 
   RowBox[{"X", ",", 
    SubscriptBox["T", "0"]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.726849740050623*^9, 
  3.726849742506377*^9}},ExpressionUUID->"f41d2417-db89-4d59-8c91-\
67627fb19217"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ",", "b", ",", "t0"}], "}"}]], "Output",
 CellChangeTimes->{3.726849742821046*^9, 3.726924733364122*^9, 
  3.726930256395924*^9, 
  3.726930404615657*^9},ExpressionUUID->"6ab95b87-aedd-449a-a73a-\
f928b9147f87"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FreeAlgebra", "[", 
    RowBox[{"set_", ",", "type_", ",", "depth_"}], "]"}], ":=", 
   RowBox[{"Return", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      SubscriptBox["T", "0"], " ", "has", " ", "the", " ", "arity", " ", "0", 
      " ", "elements"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["T", 
       RowBox[{"0", " "}]], "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"type", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "/.", 
            RowBox[{"type", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "\[Equal]", "0"}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Define", " ", 
       SubscriptBox["F", 
        RowBox[{"0", " "}]]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["F", "0"], " ", "=", " ", 
      RowBox[{"Union", "[", 
       RowBox[{"set", ",", 
        SubscriptBox["T", "0"]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"rules", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"0", "\[Rule]", " ", 
        SubscriptBox["F", "0"]}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"k", "\[LessEqual]", " ", "depth"}], ",", " ", 
       RowBox[{"k", "++"}], ",", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Initialize", " ", "with", " ", "template"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["F", "k"], " ", "=", " ", 
         RowBox[{"F", "[", 
          RowBox[{"k", ",", "type"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "replace", " ", "template", " ", "with", " ", "previous", " ", 
          SubscriptBox["F", "k"]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["F", "k"], "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "/.", "rules"}], "&"}], ",", 
           SubscriptBox["F", "k"]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Expand", " ", "Set", " ", 
          SubscriptBox["F", "k"], " ", "to", " ", "cartesian", " ", 
          "product"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["F", 
          RowBox[{"k", " "}]], "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"genCartesianProduct", "[", 
               RowBox[{"FlattenAt", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "&"}], ",", " ", 
             SubscriptBox["F", "k"]}], "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Add", " ", "a", " ", "new", " ", "rule", " ", "for", " ", 
          "substituting", " ", "at", " ", "the", " ", "next", " ", "level"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"rules", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"rules", ",", " ", 
           RowBox[{"{", 
            RowBox[{"k", "\[Rule]", 
             SubscriptBox["F", "k"]}], "}"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"repartition", " ", "the", " ", "set"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"k", "\[LessEqual]", " ", "depth"}], ",", " ", 
       RowBox[{"k", "++"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["F", "k"], "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"rePartition", ",", 
           SubscriptBox["F", "k"]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.726924775098462*^9, 3.7269250040699587`*^9}, 
   3.72692520546253*^9, {3.726925327834538*^9, 3.726925338974882*^9}, {
   3.726925388144927*^9, 3.7269253984927807`*^9}, {3.726925447935433*^9, 
   3.726925448555114*^9}, {3.726925579805306*^9, 3.7269256402122917`*^9}, {
   3.726925676401793*^9, 3.726925682229397*^9}, {3.7269257718387012`*^9, 
   3.726925787150074*^9}, {3.726925893483976*^9, 3.726925956105784*^9}, {
   3.72692601705727*^9, 3.726926047365375*^9}, 3.72692630436453*^9, {
   3.726926904249412*^9, 3.7269269064777412`*^9}, {3.726926959837964*^9, 
   3.726926992173829*^9}, {3.726927032708415*^9, 3.726927095479615*^9}, {
   3.7269272063486843`*^9, 3.72692720979289*^9}, {3.726927976332301*^9, 
   3.726928083251155*^9}, {3.726928619277072*^9, 3.7269286366675386`*^9}, {
   3.72692885171177*^9, 3.726928868691869*^9}, {3.726930265613349*^9, 
   3.726930315185038*^9}, {3.726930408519696*^9, 3.726930439976265*^9}, {
   3.726930473748168*^9, 
   3.726930577904255*^9}},ExpressionUUID->"61392174-fd09-48a1-aeeb-\
da301f82bd3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Create a Free Algebra on the set and type up to a certain level\
\>", "Subsection",
 CellChangeTimes->{{3.726930829203012*^9, 3.72693083232969*^9}, {
  3.726930883218836*^9, 
  3.726930896618273*^9}},ExpressionUUID->"7feec64f-b3bc-49ac-aa33-\
71f81261e428"],

Cell[BoxData[
 RowBox[{"FreeAlgebra", "[", 
  RowBox[{"X", ",", "T", ",", " ", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.726925045045725*^9, 3.726925051220703*^9}, {
  3.726926257057032*^9, 3.726926257312949*^9}, {3.726926921902125*^9, 
  3.726926921971567*^9}, {3.7269286542062807`*^9, 3.726928654283803*^9}, {
  3.726930582879034*^9, 
  3.7269305830539618`*^9}},ExpressionUUID->"921eb32f-d882-4b1b-b593-\
3cc80a3363b8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  SubscriptBox["F", "0"], "]"}]], "Input",
 CellChangeTimes->{{3.726930662899746*^9, 
  3.72693066889993*^9}},ExpressionUUID->"97bed0b6-740a-4cc5-95a7-\
197b9c450ba6"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{3.726930669315303*^9, 
  3.726930913462468*^9},ExpressionUUID->"ba8e923f-f86c-43e5-85fb-\
ed8a52e59a65"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  SubscriptBox["F", "1"], "]"}]], "Input",
 CellChangeTimes->{{3.726930652460504*^9, 
  3.7269306609719667`*^9}},ExpressionUUID->"6a00a8b2-4565-4201-9597-\
14a3bbb22b4b"],

Cell[BoxData["12"], "Output",
 CellChangeTimes->{3.726930661322918*^9, 
  3.726930917185556*^9},ExpressionUUID->"85cb4b07-e5c5-450c-9cdf-\
f45253fadf42"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  SubscriptBox["F", "2"], "]"}]], "Input",
 CellChangeTimes->{{3.726930640000146*^9, 
  3.7269306475719213`*^9}},ExpressionUUID->"daf0428e-8bb7-4d9c-b9dc-\
ce8cad488c44"],

Cell[BoxData["84"], "Output",
 CellChangeTimes->{3.7269306479701967`*^9, 
  3.726930918579936*^9},ExpressionUUID->"3c31e39b-9ecf-4e1e-8ccc-\
d1113d3d428f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  SubscriptBox["F", "3"], "]"}]], "Input",
 CellChangeTimes->{{3.726930635144261*^9, 
  3.726930638140018*^9}},ExpressionUUID->"6974ab22-e6d6-4970-baf1-\
a3d249f7eaba"],

Cell[BoxData["732"], "Output",
 CellChangeTimes->{3.726930638568042*^9, 
  3.726930920164444*^9},ExpressionUUID->"10e77fb4-2787-4dbe-b2dc-\
eaa47f334e12"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  SubscriptBox["F", "4"], "]"}]], "Input",
 CellChangeTimes->{{3.726930628392928*^9, 
  3.726930632411981*^9}},ExpressionUUID->"170aa9ec-e3a1-477f-ae9a-\
fd08c017f0b0"],

Cell[BoxData["7140"], "Output",
 CellChangeTimes->{3.7269306327320766`*^9, 
  3.726930922358622*^9},ExpressionUUID->"c795bbfd-6b5c-47b0-8e74-\
68f34f05fb4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  SubscriptBox["F", "5"], "]"}]], "Input",
 CellChangeTimes->{{3.726930618993436*^9, 
  3.7269306248919163`*^9}},ExpressionUUID->"b66422f5-2989-4034-a7f2-\
bc905a4f9352"],

Cell[BoxData["74604"], "Output",
 CellChangeTimes->{3.726930625117235*^9, 
  3.726930925469145*^9},ExpressionUUID->"23f04b1b-faf0-429c-98bb-\
8fa78fc5f929"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox["F", "0"]], "Input",
 CellChangeTimes->{{3.726925059226625*^9, 
  3.72692506100456*^9}},ExpressionUUID->"645042f4-83b2-4a4a-8a60-\
f66165697db4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"a", ",", "b", ",", "t0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.726925061503791*^9, 3.726925343720645*^9, 3.726925402482278*^9, 
   3.726925453034041*^9, {3.7269256089055433`*^9, 3.72692565152813*^9}, 
   3.726925686278708*^9, 3.7269257923336973`*^9, {3.726925899560305*^9, 
   3.7269259281855183`*^9}, 3.7269259902280197`*^9, {3.726926911242612*^9, 
   3.726926923629601*^9}, {3.726926973928851*^9, 3.726927000275339*^9}, 
   3.7269270849191217`*^9, 3.726927214471814*^9, 3.726927605835763*^9, {
   3.726927997135498*^9, 3.726928070862924*^9}, 3.726928516803679*^9, 
   3.726928641314767*^9, 3.726930338946968*^9, 3.7269304438579903`*^9, 
   3.7269306733804502`*^9, 
   3.726930927031269*^9},ExpressionUUID->"dc86c8fb-5b14-497a-8afc-\
68f05c34a5d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Column", "[", 
  SubscriptBox["F", "1"], "]"}]], "Input",
 CellChangeTimes->{{3.726927943913062*^9, 3.7269279449443808`*^9}, {
  3.7269280016890793`*^9, 3.726928002903862*^9}, {3.726930699087017*^9, 
  3.726930701731472*^9}},ExpressionUUID->"4f12fb5b-4d26-4f7c-b993-\
21cc121618fc"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.726928003163274*^9, 3.726928073008502*^9}, 
   3.7269285183782177`*^9, 3.72692864286087*^9, 3.726928872019787*^9, 
   3.726930340468501*^9, 3.7269304449196777`*^9, {3.726930674699122*^9, 
   3.726930702026567*^9}},ExpressionUUID->"4507a1c1-4013-47f2-b348-\
accf787dc4ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Column", "[", 
  SubscriptBox["F", "2"], "]"}]], "Input",
 CellChangeTimes->{{3.726928645985793*^9, 3.726928648067688*^9}, {
  3.726930344235591*^9, 3.726930348346574*^9}, {3.726930692792315*^9, 
  3.7269306962597218`*^9}},ExpressionUUID->"8ca62e91-d325-478a-a881-\
6d7acef385e8"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "a", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", "b", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", "t0", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "a"}], "}"}], ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "a"}], "}"}], ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "a"}], "}"}], ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "b"}], "}"}], ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "b"}], "}"}], ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "b"}], "}"}], ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}], ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}], ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}], ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "a"}], "}"}], ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "a"}], "}"}], ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "a"}], "}"}], ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "b"}], "}"}], ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "b"}], "}"}], ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", "b"}], "}"}], ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}], ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}], ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}], ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "a"}], "}"}], ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "a"}], "}"}], ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "a"}], "}"}], ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "b"}], "}"}], ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "b"}], "}"}], ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", "b"}], "}"}], ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}], ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}], ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}], ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "a"}], "}"}], ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "a"}], "}"}], ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "a"}], "}"}], ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "b"}], "}"}], ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "b"}], "}"}], ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", "b"}], "}"}], ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}], ",", "a"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}], ",", "b"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}], ",", 
       RowBox[{"{", "t0", "}"}]}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.72692864849964*^9, 3.726928873339476*^9, 3.726930348694045*^9, 
   3.72693044697983*^9, {3.726930676238645*^9, 
   3.726930696512721*^9}},ExpressionUUID->"349c58e5-5ab6-4e8e-9b0e-\
aacf297ba5ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Column", "[", 
  RowBox[{
   SubscriptBox["F", "3"], "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "75"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7269286573877583`*^9, 3.726928658867752*^9}, {
  3.7269303513222847`*^9, 3.7269303637829933`*^9}, {3.726930934171094*^9, 
  3.726930941841617*^9}},ExpressionUUID->"1e7848b4-5250-4fc5-b56f-\
1605a1640f0a"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", 
           RowBox[{"{", "t0", "}"}], ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", 
           RowBox[{"{", "t0", "}"}], ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t1", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", 
           RowBox[{"{", "t0", "}"}], ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", 
           RowBox[{"{", "t0", "}"}], ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", 
           RowBox[{"{", "t0", "}"}], ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "a", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", 
           RowBox[{"{", "t0", "}"}], ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", 
           RowBox[{"{", "t0", "}"}], ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", 
           RowBox[{"{", "t0", "}"}], ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", "b", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", 
           RowBox[{"{", "t0", "}"}], ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", 
           RowBox[{"{", "t0", "}"}], ",", "a"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", 
           RowBox[{"{", "t0", "}"}], ",", "b"}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", "t0", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", 
           RowBox[{"{", "t0", "}"}], ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "a"}], "}"}], ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "a"}], "}"}], ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "a"}], "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "b"}], "}"}], ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "b"}], "}"}], ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "b"}], "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}], ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}], ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "a"}], "}"}], ",", "a"}], "}"}]}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "a"}], "}"}], ",", "b"}], "}"}]}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "b"}], "}"}], ",", "a"}], "}"}]}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "b"}], "}"}], ",", "b"}], "}"}]}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", "b"}], "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}], ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}], ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "a", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "a"}], "}"}], ",", "a"}], "}"}]}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "a"}], "}"}], ",", "b"}], "}"}]}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "a"}], "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "b"}], "}"}], ",", "a"}], "}"}]}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "b"}], "}"}], ",", "b"}], "}"}]}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", "b"}], "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}], ",", "a"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}], ",", "b"}], "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{"t2", ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "b", ",", 
           RowBox[{"{", "t0", "}"}]}], "}"}], ",", 
         RowBox[{"{", "t0", "}"}]}], "}"}]}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.726928877326146*^9, {3.726930353774014*^9, 3.726930366468539*^9}, 
   3.726930450190742*^9, 3.726930678568089*^9, 
   3.726930942133197*^9},ExpressionUUID->"5dea5d9e-850e-4c19-b399-\
d4a90a0babc8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Draft", " ", "Code"}], "Section"], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
  "(*", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FreeAlgebra", "[", 
      RowBox[{"set_", ",", "type_", ",", "depth_"}], "]"}], ":=", 
     RowBox[{"Return", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"free", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["T", "0"], " ", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"type", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/.", "ar"}], ")"}], "\[Equal]", "0"}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["F", "0"], " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"set", ",", 
          SubscriptBox["T", "0"]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", " ", "=", "1"}], " ", ",", 
         RowBox[{"k", "\[LessEqual]", " ", "depth"}], ",", 
         RowBox[{"++", "k"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"f", " ", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"f", "=", " ", 
           RowBox[{"F", "[", 
            RowBox[{"k", ",", "type"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "k", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "f", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"free", ",", "f"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "free"}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FreeAlgebra", "[", 
      RowBox[{"set_", ",", "type_", ",", "depth_"}], "]"}], ":=", 
     RowBox[{"Return", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"free", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["T", "0"], " ", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"type", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/.", "ar"}], ")"}], "\[Equal]", "0"}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["F", "0"], " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"set", ",", 
          SubscriptBox["T", "0"]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", " ", "=", "1"}], " ", ",", 
         RowBox[{"k", "\[LessEqual]", " ", "depth"}], ",", 
         RowBox[{"++", "k"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["F", "k"], " ", "=", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"genCartesianProduct", ",", 
               RowBox[{"F", "[", 
                RowBox[{"k", ",", "T"}], "]"}]}], "]"}], ",", "1"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"free", ",", 
            SubscriptBox["F", "k"]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "free"}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"k", " ", "=", " ", "1"}], ",", " ", 
      RowBox[{"k", " ", "\[LessEqual]", " ", 
       RowBox[{"Length", "[", "ft1", "]"}]}], ",", 
      RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"set", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"ft1", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"p", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"p", " ", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", "set", "]"}]}], ",", 
         RowBox[{"++", "p"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ft1", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "2"}], "]"}], "]"}], " ", "=", 
          "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{"ft1", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "2"}], "]"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"set", "[", 
             RowBox[{"[", "p", "]"}], "]"}], "\[Rule]", " ", 
            SubscriptBox["F", 
             RowBox[{"set", "[", 
              RowBox[{"[", "p", "]"}], "]"}]]}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"freeAlgebra", "[", 
      RowBox[{"depth_", ",", "type_", ",", "set_"}], "]"}], ":=", " ", 
     RowBox[{"Return", "[", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"F", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"n", " ", "=", " ", "1"}], ",", " ", 
         RowBox[{"n", "\[LessEqual]", " ", "depth"}], ",", 
         RowBox[{"n", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"f", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"For", " ", "each", " ", "operatior"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", " ", "=", " ", "1"}], ",", 
            RowBox[{"j", " ", "\[LessEqual]", " ", 
             RowBox[{"Length", "[", 
              RowBox[{"type", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], " ", ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"type", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "j"}], "]"}], "]"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"a", " ", "=", " ", 
              RowBox[{
               RowBox[{"type", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "j"}], "]"}], "]"}], "/.", " ", "ar"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "a", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"partitions", "[", 
               RowBox[{
                RowBox[{"depth", "-", "1"}], ",", " ", "a"}], "]"}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"cp", " ", "=", " ", 
              RowBox[{"CartesianProduct", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"type", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "j"}], "]"}], "]"}], "}"}], ",", 
                RowBox[{"partitions", "[", 
                 RowBox[{
                  RowBox[{"depth", "-", "1"}], ",", " ", "a"}], "]"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "cp", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"f", ",", "cp"}], "]"}], ";"}]}], "\[IndentingNewLine]",
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"F", ",", "f"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{"depth_", ",", "type_"}], "]"}], ":=", " ", 
     RowBox[{"Return", "[", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"f", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"For", " ", "each", " ", "operatior"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", " ", "=", " ", "1"}], ",", 
         RowBox[{"j", " ", "\[LessEqual]", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"type", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], " ", ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"arity", " ", "=", " ", 
           RowBox[{
            RowBox[{"type", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "j"}], "]"}], "]"}], "/.", " ", "ar"}]}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"cp", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"type", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "j"}], "]"}], "]"}], "}"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["F", "#"], "&"}], ",", 
               RowBox[{
                RowBox[{"partitions", "[", 
                 RowBox[{
                  RowBox[{"depth", "-", "1"}], ",", " ", "arity"}], "]"}], 
                "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cp", " ", "=", " ", 
           RowBox[{"FlattenAt", "[", 
            RowBox[{"cp", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"f", " ", "=", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"f", ",", "cp"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "f"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.726842229797308*^9, 3.726842246385826*^9}, {
  3.726842301425304*^9, 3.726842314569618*^9}, {3.726842350792267*^9, 
  3.726842356414917*^9}, {3.726842407844821*^9, 3.7268424864915743`*^9}, {
  3.7268425949334297`*^9, 3.726842652310371*^9}, {3.726842700582857*^9, 
  3.726842723477737*^9}, {3.726842909080105*^9, 3.726842949687419*^9}, {
  3.726842979857155*^9, 3.726843015014847*^9}, {3.726844580556345*^9, 
  3.726844581084484*^9}, {3.726849617313961*^9, 3.726849648655036*^9}, {
  3.726849683314748*^9, 3.726849687098819*^9}, {3.7268499717439137`*^9, 
  3.726850018909663*^9}, {3.72692868764258*^9, 3.726928734275857*^9}, {
  3.726928766124881*^9, 
  3.726928817461238*^9}},ExpressionUUID->"4b6f3dc9-e8cd-4f6b-ae58-\
42d2bb81a939"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{806, 571},
WindowMargins->{{189, Automatic}, {Automatic, 13}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 498, 12, 150, "Chapter", "ExpressionUUID" -> \
"d86b0f59-3120-432d-9e0c-18d4d2cc1c63"],
Cell[1081, 36, 207, 4, 32, "Input", "ExpressionUUID" -> \
"703483ff-51dc-4866-9cd6-1c90737f2b23"],
Cell[1291, 42, 709, 15, 66, "Input", "ExpressionUUID" -> \
"85b6d06e-4233-4f89-9cef-d35747bc0762"],
Cell[2003, 59, 238, 5, 32, "Input", "ExpressionUUID" -> \
"e38b899b-2004-49af-97eb-513fcdaa44b8"],
Cell[2244, 66, 10111, 248, 1293, "Input", "ExpressionUUID" -> \
"df4ede1b-780f-4ded-95e2-f602cccfe8fb"],
Cell[CellGroupData[{
Cell[12380, 318, 368, 10, 46, "Subsection", "ExpressionUUID" -> \
"b142a881-cb18-4eff-9c8e-0b399f4fa3ec"],
Cell[12751, 330, 1299, 36, 161, "Input", "ExpressionUUID" -> \
"3c339186-162a-459c-bb2a-cbded43bf39a"],
Cell[14053, 368, 530, 12, 32, "Input", "ExpressionUUID" -> \
"905f07fb-6a73-4192-b0bf-8d7ef5181294"],
Cell[CellGroupData[{
Cell[14608, 384, 369, 7, 32, "Input", "ExpressionUUID" -> \
"9b584e6e-7e03-4d18-81e7-1d76fb695859"],
Cell[14980, 393, 902, 14, 32, "Output", "ExpressionUUID" -> \
"48a12df7-eff1-4d0e-91cd-d8259a9aba60"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15919, 412, 205, 5, 32, "Input", "ExpressionUUID" -> \
"fc93898d-3d5a-4b99-aea2-89839972ce1c"],
Cell[16127, 419, 668, 12, 32, "Output", "ExpressionUUID" -> \
"b642c82a-8328-43b4-9e09-7abc7e41562f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16844, 437, 317, 9, 46, "Subsection", "ExpressionUUID" -> \
"9ff5fc5f-efd5-4c0f-872e-f3923a3d0501"],
Cell[17164, 448, 297, 7, 32, "Input", "ExpressionUUID" -> \
"56843c93-3015-44e3-b83d-25ea5fdc9b0e"],
Cell[CellGroupData[{
Cell[17486, 459, 283, 7, 32, "Input", "ExpressionUUID" -> \
"4d6a05a5-4129-4925-b446-fddded318311"],
Cell[17772, 468, 265, 6, 32, "Output", "ExpressionUUID" -> \
"12a766bf-af2b-48b8-9f2d-a993c6a542c6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18086, 480, 334, 10, 45, "Subsection", "ExpressionUUID" -> \
"59a3d124-b685-4383-8353-ec35d547a2ec"],
Cell[CellGroupData[{
Cell[18445, 494, 287, 8, 32, "Input", "ExpressionUUID" -> \
"f41d2417-db89-4d59-8c91-67627fb19217"],
Cell[18735, 504, 255, 6, 32, "Output", "ExpressionUUID" -> \
"6ab95b87-aedd-449a-a73a-f928b9147f87"]
}, Open  ]],
Cell[19005, 513, 5472, 128, 600, "Input", "ExpressionUUID" -> \
"61392174-fd09-48a1-aeeb-da301f82bd3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24514, 646, 267, 6, 44, "Subsection", "ExpressionUUID" -> \
"7feec64f-b3bc-49ac-aa33-71f81261e428"],
Cell[24784, 654, 425, 8, 32, "Input", "ExpressionUUID" -> \
"921eb32f-d882-4b1b-b593-3cc80a3363b8"],
Cell[CellGroupData[{
Cell[25234, 666, 206, 5, 32, "Input", "ExpressionUUID" -> \
"97bed0b6-740a-4cc5-95a7-197b9c450ba6"],
Cell[25443, 673, 152, 3, 32, "Output", "ExpressionUUID" -> \
"ba8e923f-f86c-43e5-85fb-ed8a52e59a65"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25632, 681, 209, 5, 32, "Input", "ExpressionUUID" -> \
"6a00a8b2-4565-4201-9597-14a3bbb22b4b"],
Cell[25844, 688, 153, 3, 32, "Output", "ExpressionUUID" -> \
"85cb4b07-e5c5-450c-9cdf-f45253fadf42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26034, 696, 209, 5, 32, "Input", "ExpressionUUID" -> \
"daf0428e-8bb7-4d9c-b9dc-ce8cad488c44"],
Cell[26246, 703, 155, 3, 32, "Output", "ExpressionUUID" -> \
"3c31e39b-9ecf-4e1e-8ccc-d1113d3d428f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26438, 711, 207, 5, 32, "Input", "ExpressionUUID" -> \
"6974ab22-e6d6-4970-baf1-a3d249f7eaba"],
Cell[26648, 718, 154, 3, 32, "Output", "ExpressionUUID" -> \
"10e77fb4-2787-4dbe-b2dc-eaa47f334e12"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26839, 726, 207, 5, 32, "Input", "ExpressionUUID" -> \
"170aa9ec-e3a1-477f-ae9a-fd08c017f0b0"],
Cell[27049, 733, 157, 3, 32, "Output", "ExpressionUUID" -> \
"c795bbfd-6b5c-47b0-8e74-68f34f05fb4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27243, 741, 209, 5, 32, "Input", "ExpressionUUID" -> \
"b66422f5-2989-4034-a7f2-bc905a4f9352"],
Cell[27455, 748, 156, 3, 66, "Output", "ExpressionUUID" -> \
"23f04b1b-faf0-429c-98bb-8fa78fc5f929"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27648, 756, 173, 4, 32, "Input", "ExpressionUUID" -> \
"645042f4-83b2-4a4a-8a60-f66165697db4"],
Cell[27824, 762, 795, 14, 32, "Output", "ExpressionUUID" -> \
"dc86c8fb-5b14-497a-8afc-68f05c34a5d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28656, 781, 306, 6, 32, "Input", "ExpressionUUID" -> \
"4f12fb5b-4d26-4f7c-b993-21cc121618fc"],
Cell[28965, 789, 1580, 54, 229, "Output", "ExpressionUUID" -> \
"4507a1c1-4013-47f2-b348-accf787dc4ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30582, 848, 304, 6, 32, "Input", "ExpressionUUID" -> \
"8ca62e91-d325-478a-a881-6d7acef385e8"],
Cell[30889, 856, 14330, 504, 1525, "Output", "ExpressionUUID" -> \
"349c58e5-5ab6-4e8e-9b0e-aacf297ba5ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45256, 1365, 388, 9, 32, "Input", "ExpressionUUID" -> \
"1e7848b4-5250-4fc5-b56f-1605a1640f0a"],
Cell[45647, 1376, 17408, 602, 1363, "Output", "ExpressionUUID" -> \
"5dea5d9e-850e-4c19-b399-d4a90a0babc8"]
}, Open  ]],
Cell[63070, 1981, 11169, 257, 1732, "Input", "ExpressionUUID" -> \
"4b6f3dc9-e8cd-4f6b-ae58-42d2bb81a939"]
}, Open  ]]
}, Open  ]]
}
]
*)

